#!/bin/bash

# –°–æ–∑–¥–∞–Ω–∏–µ –∞—Ä—Ö–∏–≤–∞ –ø—Ä–æ–µ–∫—Ç–∞ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫—É —Å Mac

echo "üì¶ –°–æ–∑–¥–∞–Ω–∏–µ –∞—Ä—Ö–∏–≤–∞ –ø—Ä–æ–µ–∫—Ç–∞..."

# –ò–º—è –∞—Ä—Ö–∏–≤–∞ —Å –¥–∞—Ç–æ–π
ARCHIVE_NAME="sdvg-project-$(date +%Y%m%d-%H%M%S).zip"

# –°–æ–∑–¥–∞–µ–º –∞—Ä—Ö–∏–≤, –∏—Å–∫–ª—é—á–∞—è –Ω–µ–Ω—É–∂–Ω—ã–µ —Ñ–∞–π–ª—ã
zip -r "$ARCHIVE_NAME" . \
    -x "*.DS_Store" \
    -x "*/.git/*" \
    -x "*/build/*" \
    -x "*/DerivedData/*" \
    -x "*/.vscode/*" \
    -x "*/xcuserdata/*" \
    -x "*.xcuserstate"

if [ $? -eq 0 ]; then
    echo "‚úÖ –ê—Ä—Ö–∏–≤ —Å–æ–∑–¥–∞–Ω: $ARCHIVE_NAME"
    echo "üìä –†–∞–∑–º–µ—Ä –∞—Ä—Ö–∏–≤–∞: $(du -sh "$ARCHIVE_NAME" | cut -f1)"
    echo ""
    echo "üéØ –≠—Ç–æ—Ç –∞—Ä—Ö–∏–≤ —Å–æ–¥–µ—Ä–∂–∏—Ç:"
    echo "   - –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –ø—Ä–æ–µ–∫—Ç–∞"
    echo "   - –ù–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –∏–∫–æ–Ω–∫–∏"
    echo "   - –í—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è —Å–±–æ—Ä–∫–∏"
    echo ""
    echo "üì® –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ñ–∞–π–ª $ARCHIVE_NAME —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫—É —Å Mac"
    echo "   –û–Ω —Å–º–æ–∂–µ—Ç –æ—Ç–∫—Ä—ã—Ç—å –ø—Ä–æ–µ–∫—Ç –≤ Xcode –∏ —Å–æ–±—Ä–∞—Ç—å –≥–æ—Ç–æ–≤–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ"
else
    echo "‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∞—Ä—Ö–∏–≤–∞"
    exit 1
fi
